!function(){"use strict";var e="";const t={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit-btn",inputErrorClass:"form__input_type_error",errorClass:"form__error_visibility_shown"},r=(e,t)=>{(e=>e.some((e=>!e.validity.valid)))(e)?t.disabled=!0:t.disabled=!1},o=(e,t,r)=>{const o=t.getAttribute("name"),s=e.querySelector(`.form__error_type_${o}`);t.classList.remove(r.inputErrorClass),s.classList.remove(r.errorClass),s.textContent=""},s=e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach((t=>{t.addEventListener("submit",(e=>{e.preventDefault()})),((e,t)=>{const s=Array.from(e.querySelectorAll(t.inputSelector)),n=e.querySelector(t.submitButtonSelector);r(s,n),s.forEach((a=>{a.addEventListener("input",(()=>{((e,t,r)=>{t.validity.valid?o(e,t,r):((e,t,r,o)=>{const s=t.getAttribute("name"),n=e.querySelector(`.form__error_type_${s}`);t.classList.add(o.inputErrorClass),n.textContent=r,n.classList.add(o.errorClass)})(e,t,t.validationMessage,r)})(e,a,t),r(s,n)}))}))})(t,e)}))};s(t);var n=e+"215191cc54f1aa928dad.svg",a=e+"0f0dda9918e145f68d20.svg",c=e+"40608da7369d39bc1077.svg",i=e+"8650253b58b46f0f1c06.svg",l=e+"1ecf96fab54a91c898b4.svg",d=e+"d73f076c46eb5467f5fc.svg",u=e+"8792101a0938dc384254.svg",_=e+"dba18798529f242c4c6d.svg",m=e+"1c517008152856bd3203.svg";const h=document.querySelector("#edit-profile-modal"),p=document.querySelector("#new-post-modal"),f=document.querySelector("#post-modal"),v=document.querySelector("#delete-post-modal"),y=document.querySelector("#edit-avatar-modal"),b=document.querySelector(".profile__name"),S=document.querySelector(".profile__bio"),q=document.querySelector(".profile__avatar"),L=document.forms["edit-profile-form"],g=document.forms["edit-avatar-form"],E=g.querySelector(".form__input"),k=document.querySelector('[name="name"]'),C=document.querySelector('[name="description"]'),x=document.forms["new-post-form"],A=p.querySelector('[name="link"]'),P=document.querySelector('[name="caption"]'),U=document.querySelector(".gallery"),D=document.querySelector("#card-template").content,$=document.querySelector(".profile__edit-button"),w=document.querySelector(".profile__edit-avatar-button"),R=document.querySelector(".profile__post-button"),T=v.querySelector(".modal__button_type_delete"),I=v.querySelector(".modal__button_type_cancel"),N=L.querySelector(".form__submit-btn"),j=x.querySelector(".form__submit-btn"),O=g.querySelector(".form__submit-btn"),J=f.querySelector(".modal__image"),B=f.querySelector(".modal__caption");let H,z;const M=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_handleResponse=e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`);getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleResponse)}getCurrentUser(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handleResponse)}renderInitialDetails(){return Promise.all([this.getCurrentUser(),this.getInitialCards()]).then((([e,t])=>({userData:e,postsData:t}))).catch((e=>Promise.reject(e)))}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._handleResponse)}addNewPost({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._handleResponse)}deletePost(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}toggleLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then(this._handleResponse)}updateProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a8040853-68c0-456c-91da-f53acdcb6623","Content-Type":"application/json"}});document.querySelector(".header__logo").src=i,R.querySelector(".profile__plus-icon").src=c,$.querySelector(".profile__edit-icon").src=l,w.querySelector(".profile__edit-avatar-icon").src=d,document.querySelectorAll(".modal__exit-icon").forEach((e=>{e.src=e.classList.contains("modal__exit-icon_type_dark")?m:_}));const F=e=>{const t=document.querySelector(".modal_is-opened");e.target.classList.contains("modal")&&Q(t)},G=e=>{const t=document.querySelector(".modal_is-opened");"Escape"===e.key&&Q(t)},K=e=>{e.classList.add("modal_is-opened"),document.addEventListener("click",F),document.addEventListener("keydown",G)},Q=e=>{e.classList.remove("modal_is-opened"),document.removeEventListener("click",F),document.removeEventListener("keydown",G)},V=(e,t)=>{e.textContent=t,e.disabled=!0},W=e=>{const t=D.querySelector(".post").cloneNode(!0);t.dataset.id=e.id,t.querySelector(".post__caption").textContent=e.name;const r=t.querySelector(".post__image");r.setAttribute("src",e.link),r.setAttribute("alt",e.name);const o=t.querySelector(".post__like-button");e.isLiked&&o.classList.add("post__like-button_status_active");const s=t.querySelector(".post__like-icon");s.src=e.isLiked?a:n,o.addEventListener("click",(()=>{const t=o.classList.contains("post__like-button_status_active");M.toggleLike(e._id,t).then((e=>{const t=e.isLiked?a:n;s.setAttribute("src",t),o.classList.toggle("post__like-button_status_active")})).catch((e=>console.error(e)))}));const c=t.querySelector(".post__delete-button");return c.querySelector(".post__delete-icon").src=u,c.addEventListener("click",(()=>{((e,t)=>{H=e,z=t._id,K(v)})(t,e)})),r.addEventListener("click",(()=>{J.setAttribute("src",e.link),J.setAttribute("alt",e.name),B.textContent=e.name,K(f)})),t};$.addEventListener("click",(()=>{var e,r;k.value=b.textContent,C.value=S.textContent,e=L,r=t,[k,C].forEach((t=>{o(e,t,r)})),K(h)})),L.addEventListener("submit",(e=>{e.preventDefault(),V(N,"Saving...");const t={name:k.value,about:C.value};M.editUserInfo(t).then((e=>{b.textContent=e.name,S.textContent=e.about})).catch((e=>console.error(e))).finally((()=>{N.textContent="Save",N.disabled=!1})),Q(h)})),R.addEventListener("click",(()=>K(p))),Array.from(document.querySelectorAll(".modal__close-btn")).forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>Q(t)))})),x.addEventListener("submit",(e=>{e.preventDefault(),V(j,"Saving...");const t={name:P.value,link:A.value};M.addNewPost(t).then((e=>{const t=W(e);U.prepend(t)})).catch((e=>console.error(e))).finally((()=>{j.textContent="Save",j.disabled=!1})),x.reset(),Q(p)})),T.addEventListener("click",(()=>{V(T,"Deleting..."),M.deletePost(z).then((e=>console.log(e))).catch((e=>console.error(e))).finally((()=>{T.textContent="Delete",T.disabled=!1})),H.remove(),Q(v)})),I.addEventListener("click",(()=>{Q(v)})),g.addEventListener("submit",(e=>{e.preventDefault(),V(O,"Saving..."),M.updateProfilePicture(E.value).then((e=>{q.src=e.avatar})).catch((e=>console.error(e))).finally((()=>{O.textContent="Save",O.disabled=!1})),g.reset(),Q(y)})),w.addEventListener("click",(()=>{K(y)})),s(t),M.renderInitialDetails().then((({userData:e,postsData:t})=>{var r;r=e,b.textContent=r.name||b.textContent,S.textContent=r.about||S.textContent,q.src=r.avatar,t.forEach((e=>{const t=W(e);U.append(t)}))})).catch((e=>console.error(e)))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQ0EsSUFBSUEsRUNEb0IsR0NBeEIsTUFBTUMsRUFBVyxDQUNmQyxhQUFjLFFBQ2RDLGNBQWUsZUFDZkMscUJBQXNCLG9CQUN0QkMsZ0JBQWlCLHlCQUNqQkMsV0FBWSxnQ0FPUkMsRUFBcUJBLENBQUNDLEVBQVdDLEtBSmRELElBQ2hCQSxFQUFVRSxNQUFNQyxJQUFXQSxFQUFNQyxTQUFTQyxRQUk3Q0MsQ0FBZ0JOLEdBQ2xCQyxFQUFjTSxVQUFXLEVBRXpCTixFQUFjTSxVQUFXLEdBVXZCQyxFQUFpQkEsQ0FBQ0MsRUFBTU4sRUFBT08sS0FDbkMsTUFBTUMsRUFBWVIsRUFBTVMsYUFBYSxRQUMvQkMsRUFBZUosRUFBS0ssY0FBYyxxQkFBcUJILEtBRTdEUixFQUFNWSxVQUFVQyxPQUFPTixFQUFPYixpQkFDOUJnQixFQUFhRSxVQUFVQyxPQUFPTixFQUFPWixZQUNyQ2UsRUFBYUksWUFBYyxJQW1DdkJDLEVBQW9CUixJQUNIUyxNQUFNQyxLQUN6QkMsU0FBU0MsaUJBQWlCWixFQUFPaEIsZUFHdEI2QixTQUFTZCxJQUNwQkEsRUFBS2UsaUJBQWlCLFVBQVdDLElBQy9CQSxFQUFNQyxvQkFyQmNDLEVBQUNsQixFQUFNQyxLQUMvQixNQUFNVixFQUFZbUIsTUFBTUMsS0FBS1gsRUFBS2EsaUJBQWlCWixFQUFPZixnQkFDcERNLEVBQWdCUSxFQUFLSyxjQUFjSixFQUFPZCxzQkFFaERHLEVBQW1CQyxFQUFXQyxHQUU5QkQsRUFBVXVCLFNBQVNwQixJQUNqQkEsRUFBTXFCLGlCQUFpQixTQUFTLEtBaEJUSSxFQUFDbkIsRUFBTU4sRUFBT08sS0FDbENQLEVBQU1DLFNBQVNDLE1BS3BCRyxFQUFlQyxFQUFNTixFQUFPTyxHQWZQbUIsRUFBQ3BCLEVBQU1OLEVBQU8yQixFQUFjcEIsS0FDakQsTUFBTUMsRUFBWVIsRUFBTVMsYUFBYSxRQUMvQkMsRUFBZUosRUFBS0ssY0FBYyxxQkFBcUJILEtBRTdEUixFQUFNWSxVQUFVZ0IsSUFBSXJCLEVBQU9iLGlCQUMzQmdCLEVBQWFJLFlBQWNhLEVBQzNCakIsRUFBYUUsVUFBVWdCLElBQUlyQixFQUFPWixhQUtoQytCLENBQWVwQixFQUFNTixFQUFPQSxFQUFNNkIsa0JBQW1CdEIsSUFlbkRrQixDQUFtQm5CLEVBQU1OLEVBQU9PLEdBQ2hDWCxFQUFtQkMsRUFBV0MsVUFlaEMwQixDQUFrQmxCLEVBQU1DLE9BSTVCUSxFQUFpQnpCLEcsMlJDdERqQixNQUFNd0MsRUFBbUJaLFNBQVNQLGNBQWMsdUJBQzFDb0IsRUFBZWIsU0FBU1AsY0FBYyxtQkFDdENxQixFQUFZZCxTQUFTUCxjQUFjLGVBQ25Dc0IsRUFBa0JmLFNBQVNQLGNBQWMsc0JBQ3pDdUIsRUFBa0JoQixTQUFTUCxjQUFjLHNCQUd6Q3dCLEVBQWNqQixTQUFTUCxjQUFjLGtCQUNyQ3lCLEVBQWFsQixTQUFTUCxjQUFjLGlCQUNwQzBCLEVBQWdCbkIsU0FBU1AsY0FBYyxvQkFHdkMyQixFQUFrQnBCLFNBQVNxQixNQUFNLHFCQUNqQ0MsRUFBaUJ0QixTQUFTcUIsTUFBTSxvQkFDaENFLEVBQWtCRCxFQUFlN0IsY0FBYyxnQkFDL0MrQixFQUFZeEIsU0FBU1AsY0FBYyxpQkFDbkNnQyxFQUFXekIsU0FBU1AsY0FBYyx3QkFFbENpQyxFQUFjMUIsU0FBU3FCLE1BQU0saUJBQzdCTSxFQUFZZCxFQUFhcEIsY0FBYyxpQkFDdkNtQyxFQUFlNUIsU0FBU1AsY0FBYyxvQkFHdENvQyxFQUFVN0IsU0FBU1AsY0FBYyxZQUNqQ3FDLEVBQWU5QixTQUFTUCxjQUFjLGtCQUFrQnNDLFFBR3hEQyxFQUFpQmhDLFNBQVNQLGNBQWMseUJBQ3hDd0MsRUFBZ0JqQyxTQUFTUCxjQUFjLGdDQUN2Q3lDLEVBQWFsQyxTQUFTUCxjQUFjLHlCQUNwQzBDLEVBQXVCcEIsRUFBZ0J0QixjQUMzQyw4QkFFSTJDLEVBQTBCckIsRUFBZ0J0QixjQUM5Qyw4QkFFSTRDLEVBQXVCakIsRUFBZ0IzQixjQUFjLHFCQUNyRDZDLEVBQW1CWixFQUFZakMsY0FBYyxxQkFDN0M4QyxFQUFzQmpCLEVBQWU3QixjQUFjLHFCQUduRCtDLEVBQWlCMUIsRUFBVXJCLGNBQWMsaUJBQ3pDZ0QsRUFBbUIzQixFQUFVckIsY0FBYyxtQkFNakQsSUFBSWlELEVBQ0FDLEVBTUosTUFBTUMsRUFBTSxJQ2xGTCxNQUNMQyxXQUFBQSxDQUFZQyxHQUNWQyxLQUFLQyxTQUFXRixFQUFRRyxRQUN4QkYsS0FBS0csU0FBV0osRUFBUUssT0FDMUIsQ0FFQUMsZ0JBQW1CQyxHQUNiQSxFQUFJQyxHQUFXRCxFQUFJRSxPQUNoQkMsUUFBUUMsT0FBTyxVQUFVSixFQUFJSyxVQUd0Q0MsZUFBQUEsR0FDRSxPQUFPQyxNQUFNLEdBQUdiLEtBQUtDLGlCQUFrQixDQUNyQ0csUUFBU0osS0FBS0csV0FDYlcsS0FBS2QsS0FBS0ssZ0JBQ2YsQ0FFQVUsY0FBQUEsR0FDRSxPQUFPRixNQUFNLEdBQUdiLEtBQUtDLG9CQUFxQixDQUN4Q0csUUFBU0osS0FBS0csV0FDYlcsS0FBS2QsS0FBS0ssZ0JBQ2YsQ0FFQVcsb0JBQUFBLEdBQ0UsT0FBT1AsUUFBUVEsSUFBSSxDQUFDakIsS0FBS2UsaUJBQWtCZixLQUFLWSxvQkFDN0NFLE1BQUssRUFBRUksRUFBVUMsTUFBZSxDQUMvQkQsV0FDQUMsZ0JBRURDLE9BQU9DLEdBQ0NaLFFBQVFDLE9BQU9XLElBRTVCLENBRUFDLFlBQUFBLEVBQWEsS0FBRUMsRUFBSSxNQUFFQyxJQUNuQixPQUFPWCxNQUFNLEdBQUdiLEtBQUtDLG9CQUFxQixDQUN4Q3dCLE9BQVEsUUFDUnJCLFFBQVNKLEtBQUtHLFNBQ2R1QixLQUFNQyxLQUFLQyxVQUFVLENBQUVMLE9BQU1DLFlBQzVCVixLQUFLZCxLQUFLSyxnQkFDZixDQUVBd0IsVUFBQUEsRUFBVyxLQUFFTixFQUFJLEtBQUVPLElBQ2pCLE9BQU9qQixNQUFNLEdBQUdiLEtBQUtDLGlCQUFrQixDQUNyQ3dCLE9BQVEsT0FDUnJCLFFBQVNKLEtBQUtHLFNBQ2R1QixLQUFNQyxLQUFLQyxVQUFVLENBQUVMLE9BQU1PLFdBQzVCaEIsS0FBS2QsS0FBS0ssZ0JBQ2YsQ0FFQTBCLFVBQUFBLENBQVdDLEdBQ1QsT0FBT25CLE1BQU0sR0FBR2IsS0FBS0Msa0JBQWtCK0IsSUFBTSxDQUMzQ1AsT0FBUSxTQUNSckIsUUFBU0osS0FBS0csV0FDYlcsS0FBS2QsS0FBS0ssZ0JBQ2YsQ0FFQTRCLFVBQUFBLENBQVdELEVBQUlFLEdBQ2IsT0FBT3JCLE1BQU0sR0FBR2IsS0FBS0Msa0JBQWtCK0IsVUFBWSxDQUNqRFAsT0FBUVMsRUFBVSxTQUFXLE1BQzdCOUIsUUFBU0osS0FBS0csV0FDYlcsS0FBS2QsS0FBS0ssZ0JBQ2YsQ0FFQThCLG9CQUFBQSxDQUFxQkwsR0FDbkIsT0FBT2pCLE1BQU0sR0FBR2IsS0FBS0MsMkJBQTRCLENBQy9Dd0IsT0FBUSxRQUNSckIsUUFBU0osS0FBS0csU0FDZHVCLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJRLE9BQVFOLE1BRVRoQixLQUFLZCxLQUFLSyxnQkFDZixHRFVrQixDQUNsQkgsUUFBUyxrREFDVEUsUUFBUyxDQUNQaUMsY0FBZSx1Q0FDZixlQUFnQixzQkFRcEJwRixTQUFTUCxjQUFjLGlCQUFpQjRGLElBQU1DLEVBQzlDcEQsRUFBV3pDLGNBQWMsdUJBQXVCNEYsSUFBTUUsRUFDdER2RCxFQUFldkMsY0FBYyx1QkFBdUI0RixJQUFNRyxFQUMxRHZELEVBQWN4QyxjQUFjLDhCQUE4QjRGLElBQU1JLEVBRWhFekYsU0FBU0MsaUJBQWlCLHFCQUFxQkMsU0FBU3dGLElBQ3REQSxFQUFLTCxJQUFNSyxFQUFLaEcsVUFBVWlHLFNBQVMsOEJBQy9CQyxFQUNBQyxLQU9OLE1BTU1DLEVBQWUxRixJQUNuQixNQUFNMkYsRUFBUS9GLFNBQVNQLGNBQWMsb0JBQ2pDVyxFQUFNNEYsT0FBT3RHLFVBQVVpRyxTQUFTLFVBQVVNLEVBQVdGLElBR3JERyxFQUFnQjlGLElBQ3BCLE1BQU0yRixFQUFRL0YsU0FBU1AsY0FBYyxvQkFDbkIsV0FBZFcsRUFBTStGLEtBQWtCRixFQUFXRixJQUduQ0ssRUFBYUwsSUFDakJBLEVBQU1yRyxVQUFVZ0IsSUFBSSxtQkFDcEJWLFNBQVNHLGlCQUFpQixRQUFTMkYsR0FDbkM5RixTQUFTRyxpQkFBaUIsVUFBVytGLElBR2pDRCxFQUFjRixJQUNsQkEsRUFBTXJHLFVBQVVDLE9BQU8sbUJBQ3ZCSyxTQUFTcUcsb0JBQW9CLFFBQVNQLEdBQ3RDOUYsU0FBU3FHLG9CQUFvQixVQUFXSCxJQXVCcENJLEVBQWtCQSxDQUFDQyxFQUFTQyxLQUNoQ0QsRUFBUTNHLFlBQWM0RyxFQUN0QkQsRUFBUXJILFVBQVcsR0FPZnVILEVBQWtCQyxJQUN0QixNQUFNQyxFQUFjN0UsRUFBYXJDLGNBQWMsU0FBU21ILFdBQVUsR0FDbEVELEVBQVlFLFFBQVE5QixHQUFLMkIsRUFBSzNCLEdBRVo0QixFQUFZbEgsY0FBYyxrQkFDbENHLFlBQWM4RyxFQUFLcEMsS0FFN0IsTUFBTXdDLEVBQVlILEVBQVlsSCxjQUFjLGdCQUM1Q3FILEVBQVVDLGFBQWEsTUFBT0wsRUFBSzdCLE1BQ25DaUMsRUFBVUMsYUFBYSxNQUFPTCxFQUFLcEMsTUFFbkMsTUFBTTBDLEVBQVVMLEVBQVlsSCxjQUFjLHNCQUN0Q2lILEVBQUt6QixTQUNQK0IsRUFBUXRILFVBQVVnQixJQUFJLG1DQUd4QixNQUFNdUcsRUFBV04sRUFBWWxILGNBQWMsb0JBQzNDd0gsRUFBUzVCLElBQU1xQixFQUFLekIsUUFBVWlDLEVBQXVCQyxFQUVyREgsRUFBUTdHLGlCQUFpQixTQUFTLEtBQ2hDLE1BQU04RSxFQUFVK0IsRUFBUXRILFVBQVVpRyxTQUNoQyxtQ0FHRi9DLEVBQ0dvQyxXQUFXMEIsRUFBS1UsSUFBS25DLEdBQ3JCcEIsTUFBTVIsSUFDTCxNQUFNZ0MsRUFBTWhDLEVBQUk0QixRQUFVaUMsRUFBdUJDLEVBQ2pERixFQUFTRixhQUFhLE1BQU8xQixHQUM3QjJCLEVBQVF0SCxVQUFVMkgsT0FBTyxzQ0FFMUJsRCxPQUFPQyxHQUFVa0QsUUFBUWxELE1BQU1BLFFBR3BDLE1BQU1tRCxFQUFZWixFQUFZbEgsY0FBYyx3QkFhNUMsT0FaQThILEVBQVU5SCxjQUFjLHNCQUFzQjRGLElBQU1tQyxFQUNwREQsRUFBVXBILGlCQUFpQixTQUFTLEtBakVic0gsRUFBQ2QsRUFBYUQsS0FDckNoRSxFQUFlaUUsRUFDZmhFLEVBQWlCK0QsRUFBS1UsSUFDdEJoQixFQUFVckYsSUErRFIwRyxDQUFpQmQsRUFBYUQsTUFHaENJLEVBQVUzRyxpQkFBaUIsU0FBUyxLQUNsQ3FDLEVBQWV1RSxhQUFhLE1BQU9MLEVBQUs3QixNQUN4Q3JDLEVBQWV1RSxhQUFhLE1BQU9MLEVBQUtwQyxNQUN4QzdCLEVBQWlCN0MsWUFBYzhHLEVBQUtwQyxLQUNwQzhCLEVBQVV0RixNQUdMNkYsR0FRVDNFLEVBQWU3QixpQkFBaUIsU0FBUyxLRHpNaEJ1SCxJQUFDdEksRUFBaUJDLEVDME16Q21DLEVBQVVtRyxNQUFRMUcsRUFBWXJCLFlBQzlCNkIsRUFBU2tHLE1BQVF6RyxFQUFXdEIsWUQzTUpSLEVDNE1QZ0MsRUQ1TXdCL0IsRUM0TWdCakIsRUFBdkIsQ0FBQ29ELEVBQVdDLEdEM01wQ3ZCLFNBQVNwQixJQUNqQkssRUFBZUMsRUFBTU4sRUFBT08sTUMyTTlCK0csRUFBVXhGLE1BSVpRLEVBQWdCakIsaUJBQWlCLFVBQVdDLElBQzFDQSxFQUFNQyxpQkFDTmlHLEVBQWdCakUsRUFBc0IsYUFFdEMsTUFBTXVGLEVBQVMsQ0FDYnRELEtBQU05QyxFQUFVbUcsTUFDaEJwRCxNQUFPOUMsRUFBU2tHLE9BR2xCL0UsRUFDR3lCLGFBQWF1RCxHQUNiL0QsTUFBTVIsSUFDTHBDLEVBQVlyQixZQUFjeUQsRUFBSWlCLEtBQzlCcEQsRUFBV3RCLFlBQWN5RCxFQUFJa0IsU0FFOUJKLE9BQU9DLEdBQVVrRCxRQUFRbEQsTUFBTUEsS0FDL0J5RCxTQUFRLEtBQ1B4RixFQUFxQnpDLFlBQWMsT0FDbkN5QyxFQUFxQm5ELFVBQVcsS0FHcEMrRyxFQUFXckYsTUFJYnNCLEVBQVcvQixpQkFBaUIsU0FBUyxJQUFNaUcsRUFBVXZGLEtBR3JEZixNQUFNQyxLQUFLQyxTQUFTQyxpQkFBaUIsc0JBQXNCQyxTQUFTNEgsSUFDbEUsTUFBTS9CLEVBQVErQixFQUFPQyxRQUFRLFVBQzdCRCxFQUFPM0gsaUJBQWlCLFNBQVMsSUFBTThGLEVBQVdGLFFBNkJwRHJFLEVBQVl2QixpQkFBaUIsVUF6QlBDLElBQ3BCQSxFQUFNQyxpQkFDTmlHLEVBQWdCaEUsRUFBa0IsYUFFbEMsTUFBTTBGLEVBQVUsQ0FDZDFELEtBQU0xQyxFQUFhK0YsTUFDbkI5QyxLQUFNbEQsRUFBVWdHLE9BR2xCL0UsRUFDR2dDLFdBQVdvRCxHQUNYbkUsTUFBTVIsSUFDTCxNQUFNc0QsRUFBY0YsRUFBZXBELEdBQ25DeEIsRUFBUW9HLFFBQVF0QixNQUVqQnhDLE9BQU9DLEdBQVVrRCxRQUFRbEQsTUFBTUEsS0FDL0J5RCxTQUFRLEtBQ1B2RixFQUFpQjFDLFlBQWMsT0FDL0IwQyxFQUFpQnBELFVBQVcsS0FHaEN3QyxFQUFZd0csUUFDWmpDLEVBQVdwRixNQUtic0IsRUFBcUJoQyxpQkFBaUIsU0FBUyxLQWxKN0NtRyxFQUFnQm5FLEVBQXNCLGVBQ3RDUyxFQUNHa0MsV0FBV25DLEdBQ1hrQixNQUFNUixHQUFRaUUsUUFBUWEsSUFBSTlFLEtBQzFCYyxPQUFPQyxHQUFVa0QsUUFBUWxELE1BQU1BLEtBQy9CeUQsU0FBUSxLQUNQMUYsRUFBcUJ2QyxZQUFjLFNBQ25DdUMsRUFBcUJqRCxVQUFXLEtBRXBDd0QsRUFBYS9DLFNBQ2JzRyxFQUFXbEYsTUE0SWJxQixFQUF3QmpDLGlCQUFpQixTQUFTLEtBQ2hEOEYsRUFBV2xGLE1BR2JPLEVBQWVuQixpQkFBaUIsVUFBV2lJLElBQ3pDQSxFQUFJL0gsaUJBRUppRyxFQUFnQi9ELEVBQXFCLGFBRXJDSyxFQUNHc0MscUJBQXFCM0QsRUFBZ0JvRyxPQUNyQzlELE1BQU1SLElBQ0xsQyxFQUFja0UsSUFBTWhDLEVBQUk4QixVQUV6QmhCLE9BQU9DLEdBQVVrRCxRQUFRbEQsTUFBTUEsS0FDL0J5RCxTQUFRLEtBQ1B0RixFQUFvQjNDLFlBQWMsT0FDbEMyQyxFQUFvQnJELFVBQVcsS0FHbkNvQyxFQUFlNEcsUUFDZmpDLEVBQVdqRixNQUdiaUIsRUFBYzlCLGlCQUFpQixTQUFTLEtBQ3RDaUcsRUFBVXBGLE1BT1puQixFQUFpQnpCLEdBRWpCd0UsRUFDR21CLHVCQUNBRixNQUFLLEVBQUdJLFdBQVVDLGdCQTdOTXdDLFFBOE5MekMsRUE3TnBCaEQsRUFBWXJCLFlBQWM4RyxFQUFLcEMsTUFBUXJELEVBQVlyQixZQUNuRHNCLEVBQVd0QixZQUFjOEcsRUFBS25DLE9BQVNyRCxFQUFXdEIsWUFDbER1QixFQUFja0UsSUFBTXFCLEVBQUt2QixPQTZOdkJqQixFQUFVaEUsU0FBU21JLElBQ2pCLE1BQU0xQixFQUFjRixFQUFlNEIsR0FDbkN4RyxFQUFReUcsT0FBTzNCLFNBR2xCeEMsT0FBT0MsR0FBVWtELFFBQVFsRCxNQUFNQSxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJjb25zdCBzZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6ICcuZm9ybScsXHJcbiAgaW5wdXRTZWxlY3RvcjogJy5mb3JtX19pbnB1dCcsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcuZm9ybV9fc3VibWl0LWJ0bicsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiAnZm9ybV9faW5wdXRfdHlwZV9lcnJvcicsXHJcbiAgZXJyb3JDbGFzczogJ2Zvcm1fX2Vycm9yX3Zpc2liaWxpdHlfc2hvd24nLFxyXG59O1xyXG5cclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+ICFpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcbn07XHJcblxyXG5jb25zdCB0b2dnbGVTdWJtaXRCdXR0b24gPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KSA9PiB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IHJlc2V0SW5wdXRFcnJvcnMgPSAoZm9ybSwgaW5wdXRMaXN0LCBjb25maWcpID0+IHtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm0sIGlucHV0LCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybSwgaW5wdXQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TmFtZSA9IGlucHV0LmdldEF0dHJpYnV0ZSgnbmFtZScpO1xyXG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm0ucXVlcnlTZWxlY3RvcihgLmZvcm1fX2Vycm9yX3R5cGVfJHtpbnB1dE5hbWV9YCk7XHJcblxyXG4gIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xyXG59O1xyXG5cclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybSwgaW5wdXQsIGVycm9yTWVzc2FnZSwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgaW5wdXROYW1lID0gaW5wdXQuZ2V0QXR0cmlidXRlKCduYW1lJyk7XHJcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybS5xdWVyeVNlbGVjdG9yKGAuZm9ybV9fZXJyb3JfdHlwZV8ke2lucHV0TmFtZX1gKTtcclxuXHJcbiAgaW5wdXQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm0sIGlucHV0LCBjb25maWcpID0+IHtcclxuICBpZiAoIWlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtLCBpbnB1dCwgaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2UsIGNvbmZpZyk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBoaWRlSW5wdXRFcnJvcihmb3JtLCBpbnB1dCwgY29uZmlnKTtcclxufTtcclxuXHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm0sIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybS5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm0ucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICB0b2dnbGVTdWJtaXRCdXR0b24oaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcclxuXHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm0sIGlucHV0LCBjb25maWcpO1xyXG4gICAgICB0b2dnbGVTdWJtaXRCdXR0b24oaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtRWxlbWVudHMgPSBBcnJheS5mcm9tKFxyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSxcclxuICApO1xyXG5cclxuICBmb3JtRWxlbWVudHMuZm9yRWFjaCgoZm9ybSkgPT4ge1xyXG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm0sIGNvbmZpZyk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcclxuXHJcbmV4cG9ydCB7IHNldHRpbmdzLCBlbmFibGVWYWxpZGF0aW9uLCByZXNldElucHV0RXJyb3JzIH07XHJcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBJTVBPUlRTXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuaW1wb3J0ICcuL2luZGV4LmNzcyc7XHJcbmltcG9ydCB7IEFwaSB9IGZyb20gJy4uL3NjcmlwdHMvQXBpLmpzJztcclxuaW1wb3J0IHtcclxuICBlbmFibGVWYWxpZGF0aW9uLFxyXG4gIHNldHRpbmdzLFxyXG4gIHJlc2V0SW5wdXRFcnJvcnMsXHJcbn0gZnJvbSAnLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzJztcclxuXHJcbmltcG9ydCBsaWtlQnV0dG9uSWNvbiBmcm9tICcuLi9pbWFnZXMvbGlrZS1pY29uLnN2Zyc7XHJcbmltcG9ydCBhY3RpdmVMaWtlQnV0dG9uSWNvbiBmcm9tICcuLi9pbWFnZXMvbGlrZS1pY29uLWFjdGl2ZS5zdmcnO1xyXG5pbXBvcnQgcGx1c0ljb24gZnJvbSAnLi4vaW1hZ2VzL3BsdXMtaWNvbi5zdmcnO1xyXG5pbXBvcnQgbG9nbyBmcm9tICcuLi9pbWFnZXMvTG9nby5zdmcnO1xyXG5pbXBvcnQgZGFya0VkaXRCdXR0b24gZnJvbSAnLi4vaW1hZ2VzL2VkaXQtaWNvbi1kYXJrLnN2Zyc7XHJcbmltcG9ydCBsaWdodEVkaXRCdXR0b24gZnJvbSAnLi4vaW1hZ2VzL2VkaXQtaWNvbi1saWdodC5zdmcnO1xyXG5pbXBvcnQgZGVsZXRlSWNvbiBmcm9tICcuLi9pbWFnZXMvZGVsZXRlLWljb24uc3ZnJztcclxuaW1wb3J0IGRhcmtFeGl0QnV0dG9uIGZyb20gJy4uL2ltYWdlcy9leGl0LWljb24tZGFyay5zdmcnO1xyXG5pbXBvcnQgbGlnaHRFeGl0QnV0dG9uIGZyb20gJy4uL2ltYWdlcy9leGl0LWljb24tbGlnaHQuc3ZnJztcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBET00gU0VMRUNUT1JTXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLy8gTW9kYWxzXHJcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZWRpdC1wcm9maWxlLW1vZGFsJyk7XHJcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuZXctcG9zdC1tb2RhbCcpO1xyXG5jb25zdCBwb3N0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcG9zdC1tb2RhbCcpO1xyXG5jb25zdCBkZWxldGVQb3N0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZGVsZXRlLXBvc3QtbW9kYWwnKTtcclxuY29uc3QgZWRpdEF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2VkaXQtYXZhdGFyLW1vZGFsJyk7XHJcblxyXG4vLyBQcm9maWxlIGZpZWxkc1xyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19uYW1lJyk7XHJcbmNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYmlvJyk7XHJcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYXZhdGFyJyk7XHJcblxyXG4vLyBGb3JtcyAmIGlucHV0c1xyXG5jb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1snZWRpdC1wcm9maWxlLWZvcm0nXTtcclxuY29uc3QgZWRpdEF2YXRhckZvcm0gPSBkb2N1bWVudC5mb3Jtc1snZWRpdC1hdmF0YXItZm9ybSddO1xyXG5jb25zdCBhdmF0YXJMaW5rSW5wdXQgPSBlZGl0QXZhdGFyRm9ybS5xdWVyeVNlbGVjdG9yKCcuZm9ybV9faW5wdXQnKTtcclxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW25hbWU9XCJuYW1lXCJdJyk7XHJcbmNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW25hbWU9XCJkZXNjcmlwdGlvblwiXScpO1xyXG5cclxuY29uc3QgbmV3UG9zdEZvcm0gPSBkb2N1bWVudC5mb3Jtc1snbmV3LXBvc3QtZm9ybSddO1xyXG5jb25zdCBsaW5rSW5wdXQgPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcignW25hbWU9XCJsaW5rXCJdJyk7XHJcbmNvbnN0IGNhcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tuYW1lPVwiY2FwdGlvblwiXScpO1xyXG5cclxuLy8gQ2FyZHNcclxuY29uc3QgZ2FsbGVyeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYWxsZXJ5Jyk7XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjYXJkLXRlbXBsYXRlJykuY29udGVudDtcclxuXHJcbi8vIEJ1dHRvbnNcclxuY29uc3QgZWRpdFByb2ZpbGVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuY29uc3QgZWRpdEF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWF2YXRhci1idXR0b24nKTtcclxuY29uc3QgbmV3UG9zdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19wb3N0LWJ1dHRvbicpO1xyXG5jb25zdCBkZWxldGVNb2RhbERlbGV0ZUJ0biA9IGRlbGV0ZVBvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gICcubW9kYWxfX2J1dHRvbl90eXBlX2RlbGV0ZScsXHJcbik7XHJcbmNvbnN0IGRlbGV0ZU1vZGFsQ2FuY2VsQnV0dG9uID0gZGVsZXRlUG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgJy5tb2RhbF9fYnV0dG9uX3R5cGVfY2FuY2VsJyxcclxuKTtcclxuY29uc3QgZWRpdFByb2ZpbGVTdWJtaXRCdG4gPSBlZGl0UHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcignLmZvcm1fX3N1Ym1pdC1idG4nKTtcclxuY29uc3QgbmV3UG9zdFN1Ym1pdEJ0biA9IG5ld1Bvc3RGb3JtLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19zdWJtaXQtYnRuJyk7XHJcbmNvbnN0IGVkaXRBdmF0YXJTdWJtaXRCdG4gPSBlZGl0QXZhdGFyRm9ybS5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fc3VibWl0LWJ0bicpO1xyXG5cclxuLy8gUG9zdCBNb2RhbCBjb250ZW50XHJcbmNvbnN0IHBvc3RNb2RhbEltYWdlID0gcG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW1hZ2UnKTtcclxuY29uc3QgcG9zdE1vZGFsQ2FwdGlvbiA9IHBvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2NhcHRpb24nKTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBHTE9CQUwgVkFSSUFCTEVTXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxubGV0IHNlbGVjdGVkQ2FyZDtcclxubGV0IHNlbGVjdGVkQ2FyZElkO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIEFQSSBDT05GSUdcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiAnaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEnLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246ICdhODA0MDg1My02OGMwLTQ1NmMtOTFkYS1mNTNhY2RjYjY2MjMnLFxyXG4gICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICB9LFxyXG59KTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBVSSBJTklUSUFMSVpBVElPTlxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX2xvZ28nKS5zcmMgPSBsb2dvO1xyXG5uZXdQb3N0QnRuLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19wbHVzLWljb24nKS5zcmMgPSBwbHVzSWNvbjtcclxuZWRpdFByb2ZpbGVCdG4ucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtaWNvbicpLnNyYyA9IGRhcmtFZGl0QnV0dG9uO1xyXG5lZGl0QXZhdGFyQnRuLnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWF2YXRhci1pY29uJykuc3JjID0gbGlnaHRFZGl0QnV0dG9uO1xyXG5cclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1vZGFsX19leGl0LWljb24nKS5mb3JFYWNoKChpY29uKSA9PiB7XHJcbiAgaWNvbi5zcmMgPSBpY29uLmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX2V4aXQtaWNvbl90eXBlX2RhcmsnKVxyXG4gICAgPyBsaWdodEV4aXRCdXR0b25cclxuICAgIDogZGFya0V4aXRCdXR0b247XHJcbn0pO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFVUSUxJVFkgRlVOQ1RJT05TXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuY29uc3QgdXBkYXRlUHJvZmlsZUluZm8gPSAoZGF0YSkgPT4ge1xyXG4gIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lIHx8IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIHByb2ZpbGVKb2IudGV4dENvbnRlbnQgPSBkYXRhLmFib3V0IHx8IHByb2ZpbGVKb2IudGV4dENvbnRlbnQ7XHJcbiAgcHJvZmlsZUF2YXRhci5zcmMgPSBkYXRhLmF2YXRhcjtcclxufTtcclxuXHJcbmNvbnN0IGhhbmRsZUNsaWNrID0gKGV2ZW50KSA9PiB7XHJcbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfaXMtb3BlbmVkJyk7XHJcbiAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsJykpIGNsb3NlTW9kYWwobW9kYWwpO1xyXG59O1xyXG5cclxuY29uc3QgaGFuZGxlRXNjYXBlID0gKGV2ZW50KSA9PiB7XHJcbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfaXMtb3BlbmVkJyk7XHJcbiAgaWYgKGV2ZW50LmtleSA9PT0gJ0VzY2FwZScpIGNsb3NlTW9kYWwobW9kYWwpO1xyXG59O1xyXG5cclxuY29uc3Qgb3Blbk1vZGFsID0gKG1vZGFsKSA9PiB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZCgnbW9kYWxfaXMtb3BlbmVkJyk7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVDbGljayk7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUVzY2FwZSk7XHJcbn07XHJcblxyXG5jb25zdCBjbG9zZU1vZGFsID0gKG1vZGFsKSA9PiB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWxfaXMtb3BlbmVkJyk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVDbGljayk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUVzY2FwZSk7XHJcbn07XHJcblxyXG5jb25zdCBoYW5kbGVEZWxldGVDYXJkID0gKGNhcmRFbGVtZW50LCBkYXRhKSA9PiB7XHJcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XHJcbiAgc2VsZWN0ZWRDYXJkSWQgPSBkYXRhLl9pZDtcclxuICBvcGVuTW9kYWwoZGVsZXRlUG9zdE1vZGFsKTtcclxufTtcclxuXHJcbmNvbnN0IGhhbmRsZUNvbmZpcm1EZWxldGUgPSAoKSA9PiB7XHJcbiAgc2V0TG9hZGluZ1N0YXRlKGRlbGV0ZU1vZGFsRGVsZXRlQnRuLCAnRGVsZXRpbmcuLi4nKTtcclxuICBhcGlcclxuICAgIC5kZWxldGVQb3N0KHNlbGVjdGVkQ2FyZElkKVxyXG4gICAgLnRoZW4oKHJlcykgPT4gY29uc29sZS5sb2cocmVzKSlcclxuICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoZXJyb3IpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBkZWxldGVNb2RhbERlbGV0ZUJ0bi50ZXh0Q29udGVudCA9ICdEZWxldGUnO1xyXG4gICAgICBkZWxldGVNb2RhbERlbGV0ZUJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfSk7XHJcbiAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xyXG4gIGNsb3NlTW9kYWwoZGVsZXRlUG9zdE1vZGFsKTtcclxufTtcclxuXHJcbmNvbnN0IHNldExvYWRpbmdTdGF0ZSA9IChlbGVtZW50LCBtZXNzYWdlKSA9PiB7XHJcbiAgZWxlbWVudC50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XHJcbiAgZWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbn07XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gQ0FSRCBHRU5FUkFUT1JcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5jb25zdCBnZXRDYXJkRWxlbWVudCA9IChkYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUucXVlcnlTZWxlY3RvcignLnBvc3QnKS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgY2FyZEVsZW1lbnQuZGF0YXNldC5pZCA9IGRhdGEuaWQ7XHJcblxyXG4gIGNvbnN0IGNhcmRUaXRsZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3N0X19jYXB0aW9uJyk7XHJcbiAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG5cclxuICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9zdF9faW1hZ2UnKTtcclxuICBjYXJkSW1hZ2Uuc2V0QXR0cmlidXRlKCdzcmMnLCBkYXRhLmxpbmspO1xyXG4gIGNhcmRJbWFnZS5zZXRBdHRyaWJ1dGUoJ2FsdCcsIGRhdGEubmFtZSk7XHJcblxyXG4gIGNvbnN0IGxpa2VCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9zdF9fbGlrZS1idXR0b24nKTtcclxuICBpZiAoZGF0YS5pc0xpa2VkKSB7XHJcbiAgICBsaWtlQnRuLmNsYXNzTGlzdC5hZGQoJ3Bvc3RfX2xpa2UtYnV0dG9uX3N0YXR1c19hY3RpdmUnKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGxpa2VJY29uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvc3RfX2xpa2UtaWNvbicpO1xyXG4gIGxpa2VJY29uLnNyYyA9IGRhdGEuaXNMaWtlZCA/IGFjdGl2ZUxpa2VCdXR0b25JY29uIDogbGlrZUJ1dHRvbkljb247XHJcblxyXG4gIGxpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBjb25zdCBpc0xpa2VkID0gbGlrZUJ0bi5jbGFzc0xpc3QuY29udGFpbnMoXHJcbiAgICAgICdwb3N0X19saWtlLWJ1dHRvbl9zdGF0dXNfYWN0aXZlJyxcclxuICAgICk7XHJcblxyXG4gICAgYXBpXHJcbiAgICAgIC50b2dnbGVMaWtlKGRhdGEuX2lkLCBpc0xpa2VkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgc3JjID0gcmVzLmlzTGlrZWQgPyBhY3RpdmVMaWtlQnV0dG9uSWNvbiA6IGxpa2VCdXR0b25JY29uO1xyXG4gICAgICAgIGxpa2VJY29uLnNldEF0dHJpYnV0ZSgnc3JjJywgc3JjKTtcclxuICAgICAgICBsaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoJ3Bvc3RfX2xpa2UtYnV0dG9uX3N0YXR1c19hY3RpdmUnKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5lcnJvcihlcnJvcikpO1xyXG4gIH0pO1xyXG5cclxuICBjb25zdCBkZWxldGVCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9zdF9fZGVsZXRlLWJ1dHRvbicpO1xyXG4gIGRlbGV0ZUJ0bi5xdWVyeVNlbGVjdG9yKCcucG9zdF9fZGVsZXRlLWljb24nKS5zcmMgPSBkZWxldGVJY29uO1xyXG4gIGRlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpO1xyXG4gIH0pO1xyXG5cclxuICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBwb3N0TW9kYWxJbWFnZS5zZXRBdHRyaWJ1dGUoJ3NyYycsIGRhdGEubGluayk7XHJcbiAgICBwb3N0TW9kYWxJbWFnZS5zZXRBdHRyaWJ1dGUoJ2FsdCcsIGRhdGEubmFtZSk7XHJcbiAgICBwb3N0TW9kYWxDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgb3Blbk1vZGFsKHBvc3RNb2RhbCk7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBFVkVOVCBMSVNURU5FUlNcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLyBFZGl0IHByb2ZpbGUgYnV0dG9uXHJcbmVkaXRQcm9maWxlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIG5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIGpvYklucHV0LnZhbHVlID0gcHJvZmlsZUpvYi50ZXh0Q29udGVudDtcclxuICByZXNldElucHV0RXJyb3JzKGVkaXRQcm9maWxlRm9ybSwgW25hbWVJbnB1dCwgam9iSW5wdXRdLCBzZXR0aW5ncyk7XHJcbiAgb3Blbk1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xyXG59KTtcclxuXHJcbi8vIEVkaXQgcHJvZmlsZSBzdWJtaXRcclxuZWRpdFByb2ZpbGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldmVudCkgPT4ge1xyXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgc2V0TG9hZGluZ1N0YXRlKGVkaXRQcm9maWxlU3VibWl0QnRuLCAnU2F2aW5nLi4uJyk7XHJcblxyXG4gIGNvbnN0IHZhbHVlcyA9IHtcclxuICAgIG5hbWU6IG5hbWVJbnB1dC52YWx1ZSxcclxuICAgIGFib3V0OiBqb2JJbnB1dC52YWx1ZSxcclxuICB9O1xyXG5cclxuICBhcGlcclxuICAgIC5lZGl0VXNlckluZm8odmFsdWVzKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHJlcy5uYW1lO1xyXG4gICAgICBwcm9maWxlSm9iLnRleHRDb250ZW50ID0gcmVzLmFib3V0O1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoZXJyb3IpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBlZGl0UHJvZmlsZVN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9ICdTYXZlJztcclxuICAgICAgZWRpdFByb2ZpbGVTdWJtaXRCdG4uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xyXG59KTtcclxuXHJcbi8vIE5ldyBwb3N0IGJ1dHRvblxyXG5uZXdQb3N0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gb3Blbk1vZGFsKG5ld1Bvc3RNb2RhbCkpO1xyXG5cclxuLy8gQ2xvc2UgbW9kYWxzXHJcbkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1vZGFsX19jbG9zZS1idG4nKSkuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcbiAgY29uc3QgbW9kYWwgPSBidXR0b24uY2xvc2VzdCgnLm1vZGFsJyk7XHJcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gY2xvc2VNb2RhbChtb2RhbCkpO1xyXG59KTtcclxuXHJcbi8vIFN1Ym1pdCBuZXcgcG9zdFxyXG5jb25zdCBoYW5kbGVTdWJtaXQgPSAoZXZlbnQpID0+IHtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHNldExvYWRpbmdTdGF0ZShuZXdQb3N0U3VibWl0QnRuLCAnU2F2aW5nLi4uJyk7XHJcblxyXG4gIGNvbnN0IGNhcmRPYmogPSB7XHJcbiAgICBuYW1lOiBjYXB0aW9uSW5wdXQudmFsdWUsXHJcbiAgICBsaW5rOiBsaW5rSW5wdXQudmFsdWUsXHJcbiAgfTtcclxuXHJcbiAgYXBpXHJcbiAgICAuYWRkTmV3UG9zdChjYXJkT2JqKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KHJlcyk7XHJcbiAgICAgIGdhbGxlcnkucHJlcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5lcnJvcihlcnJvcikpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIG5ld1Bvc3RTdWJtaXRCdG4udGV4dENvbnRlbnQgPSAnU2F2ZSc7XHJcbiAgICAgIG5ld1Bvc3RTdWJtaXRCdG4uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICBuZXdQb3N0Rm9ybS5yZXNldCgpO1xyXG4gIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcclxufTtcclxuXHJcbm5ld1Bvc3RGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZVN1Ym1pdCk7XHJcblxyXG5kZWxldGVNb2RhbERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBoYW5kbGVDb25maXJtRGVsZXRlKCk7XHJcbn0pO1xyXG5cclxuZGVsZXRlTW9kYWxDYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgY2xvc2VNb2RhbChkZWxldGVQb3N0TW9kYWwpO1xyXG59KTtcclxuXHJcbmVkaXRBdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgc2V0TG9hZGluZ1N0YXRlKGVkaXRBdmF0YXJTdWJtaXRCdG4sICdTYXZpbmcuLi4nKTtcclxuXHJcbiAgYXBpXHJcbiAgICAudXBkYXRlUHJvZmlsZVBpY3R1cmUoYXZhdGFyTGlua0lucHV0LnZhbHVlKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHJlcy5hdmF0YXI7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5lcnJvcihlcnJvcikpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGVkaXRBdmF0YXJTdWJtaXRCdG4udGV4dENvbnRlbnQgPSAnU2F2ZSc7XHJcbiAgICAgIGVkaXRBdmF0YXJTdWJtaXRCdG4uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICBlZGl0QXZhdGFyRm9ybS5yZXNldCgpO1xyXG4gIGNsb3NlTW9kYWwoZWRpdEF2YXRhck1vZGFsKTtcclxufSk7XHJcblxyXG5lZGl0QXZhdGFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIG9wZW5Nb2RhbChlZGl0QXZhdGFyTW9kYWwpO1xyXG59KTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBJTklUIEFQUFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG5cclxuYXBpXHJcbiAgLnJlbmRlckluaXRpYWxEZXRhaWxzKClcclxuICAudGhlbigoeyB1c2VyRGF0YSwgcG9zdHNEYXRhIH0pID0+IHtcclxuICAgIHVwZGF0ZVByb2ZpbGVJbmZvKHVzZXJEYXRhKTtcclxuXHJcbiAgICBwb3N0c0RhdGEuZm9yRWFjaCgocG9zdCkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KHBvc3QpO1xyXG4gICAgICBnYWxsZXJ5LmFwcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoZXJyb3IpKTtcclxuIiwiZXhwb3J0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlUmVzcG9uc2UgPSAocmVzKSA9PiB7XHJcbiAgICBpZiAocmVzLm9rKSByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9O1xyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEN1cnJlbnRVc2VyKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJbml0aWFsRGV0YWlscygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRDdXJyZW50VXNlcigpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSlcclxuICAgICAgLnRoZW4oKFt1c2VyRGF0YSwgcG9zdHNEYXRhXSkgPT4gKHtcclxuICAgICAgICB1c2VyRGF0YSxcclxuICAgICAgICBwb3N0c0RhdGEsXHJcbiAgICAgIH0pKVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3UG9zdCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVQb3N0KGlkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUxpa2UoaWQsIGlzTGlrZWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gJ0RFTEVURScgOiAnUFVUJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlUHJvZmlsZVBpY3R1cmUobGluaykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInRvZ2dsZVN1Ym1pdEJ1dHRvbiIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWQiLCJoaWRlSW5wdXRFcnJvciIsImZvcm0iLCJjb25maWciLCJpbnB1dE5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJlcnJvckVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGV4dENvbnRlbnQiLCJlbmFibGVWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInByZXZlbnREZWZhdWx0Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsImFkZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiZWRpdFByb2ZpbGVNb2RhbCIsIm5ld1Bvc3RNb2RhbCIsInBvc3RNb2RhbCIsImRlbGV0ZVBvc3RNb2RhbCIsImVkaXRBdmF0YXJNb2RhbCIsInByb2ZpbGVOYW1lIiwicHJvZmlsZUpvYiIsInByb2ZpbGVBdmF0YXIiLCJlZGl0UHJvZmlsZUZvcm0iLCJmb3JtcyIsImVkaXRBdmF0YXJGb3JtIiwiYXZhdGFyTGlua0lucHV0IiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJuZXdQb3N0Rm9ybSIsImxpbmtJbnB1dCIsImNhcHRpb25JbnB1dCIsImdhbGxlcnkiLCJjYXJkVGVtcGxhdGUiLCJjb250ZW50IiwiZWRpdFByb2ZpbGVCdG4iLCJlZGl0QXZhdGFyQnRuIiwibmV3UG9zdEJ0biIsImRlbGV0ZU1vZGFsRGVsZXRlQnRuIiwiZGVsZXRlTW9kYWxDYW5jZWxCdXR0b24iLCJlZGl0UHJvZmlsZVN1Ym1pdEJ0biIsIm5ld1Bvc3RTdWJtaXRCdG4iLCJlZGl0QXZhdGFyU3VibWl0QnRuIiwicG9zdE1vZGFsSW1hZ2UiLCJwb3N0TW9kYWxDYXB0aW9uIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJhcGkiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2hhbmRsZVJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsImdldEN1cnJlbnRVc2VyIiwicmVuZGVySW5pdGlhbERldGFpbHMiLCJhbGwiLCJ1c2VyRGF0YSIsInBvc3RzRGF0YSIsImNhdGNoIiwiZXJyb3IiLCJlZGl0VXNlckluZm8iLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZE5ld1Bvc3QiLCJsaW5rIiwiZGVsZXRlUG9zdCIsImlkIiwidG9nZ2xlTGlrZSIsImlzTGlrZWQiLCJ1cGRhdGVQcm9maWxlUGljdHVyZSIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJzcmMiLCJsb2dvIiwicGx1c0ljb24iLCJkYXJrRWRpdEJ1dHRvbiIsImxpZ2h0RWRpdEJ1dHRvbiIsImljb24iLCJjb250YWlucyIsImxpZ2h0RXhpdEJ1dHRvbiIsImRhcmtFeGl0QnV0dG9uIiwiaGFuZGxlQ2xpY2siLCJtb2RhbCIsInRhcmdldCIsImNsb3NlTW9kYWwiLCJoYW5kbGVFc2NhcGUiLCJrZXkiLCJvcGVuTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0TG9hZGluZ1N0YXRlIiwiZWxlbWVudCIsIm1lc3NhZ2UiLCJnZXRDYXJkRWxlbWVudCIsImRhdGEiLCJjYXJkRWxlbWVudCIsImNsb25lTm9kZSIsImRhdGFzZXQiLCJjYXJkSW1hZ2UiLCJzZXRBdHRyaWJ1dGUiLCJsaWtlQnRuIiwibGlrZUljb24iLCJhY3RpdmVMaWtlQnV0dG9uSWNvbiIsImxpa2VCdXR0b25JY29uIiwiX2lkIiwidG9nZ2xlIiwiY29uc29sZSIsImRlbGV0ZUJ0biIsImRlbGV0ZUljb24iLCJoYW5kbGVEZWxldGVDYXJkIiwicmVzZXRJbnB1dEVycm9ycyIsInZhbHVlIiwidmFsdWVzIiwiZmluYWxseSIsImJ1dHRvbiIsImNsb3Nlc3QiLCJjYXJkT2JqIiwicHJlcGVuZCIsInJlc2V0IiwibG9nIiwiZXZ0IiwicG9zdCIsImFwcGVuZCJdLCJzb3VyY2VSb290IjoiIn0=